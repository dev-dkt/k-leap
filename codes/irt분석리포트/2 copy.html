<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한국어능력시험 문항반응이론 분석 상세 보고서</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./report-styles.css">
    <style>
        .chart-container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>한국어능력시험 문항반응이론 분석 상세 보고서</h1>

        <div class="section">
            <h2>1. 연구 개요</h2>
            <h3>1.1 연구 목적</h3>
            <p>본 연구는 한국어능력시험의 문항 특성을 문항반응이론(IRT)을 통해 분석하여 시험의 신뢰도와 타당도를 평가하고, 향후 시험 개선을 위한 기초 자료를 제공하는 것을 목적으로 합니다.</p>

            <h3>1.2 연구 방법</h3>
            <p>3모수 로지스틱 모형을 사용하여 문항의 난이도(β), 변별도(α), 추측도(c)를 추정하였습니다. 분석에는 R 소프트웨어의 ltm 패키지를 사용하였습니다.</p>

            <h3>1.3 데이터 설명</h3>
            <p>총 30명의 응시자를 대상으로 한 사전평가 결과를 분석하였습니다. 평가는 50문항의 필답형 평가와 5문항의 구술형 평가로 구성되어 있습니다.</p>
        </div>

        <div class="section">
            <h2>2. IRT 모델 적합 결과</h2>
            <h3>2.1 모델 적합도 지표</h3>
            <p>모델 적합도는 우도비 검정과 정보 기준을 통해 평가하였습니다.</p>
            <table>
                <tr><th>지표</th><th>필답형 평가</th><th>구술형 평가</th></tr>
                <tr><td>로그우도</td><td>-821.345</td><td>-76.231</td></tr>
                <tr><td>AIC</td><td>1792.69</td><td>172.462</td></tr>
                <tr><td>BIC</td><td>2015.78</td><td>186.795</td></tr>
            </table>
            
            <div class="note">
                <h4>모델 적합도 지표 해석:</h4>
                <ul>
                    <li><strong>로그우도(Log-likelihood):</strong> 값이 0에 가까울수록 모델의 적합도가 높습니다. 필답형 평가의 로그우도가 구술형 평가보다 낮은 것은 문항 수가 많아 복잡도가 높기 때문입니다.</li>
                    <li><strong>AIC (Akaike Information Criterion):</strong> 값이 작을수록 모델의 적합도가 높습니다. AIC는 모델의 복잡성을 고려하여 과적합을 방지합니다.</li>
                    <li><strong>BIC (Bayesian Information Criterion):</strong> AIC와 마찬가지로 값이 작을수록 좋으며, 표본 크기에 더 민감합니다.</li>
                </ul>
                <p>필답형 평가의 AIC와 BIC 값이 구술형 평가보다 높은 것은 문항 수가 많아 모델의 복잡도가 높기 때문입니다. 두 평가 모두 적절한 수준의 모델 적합도를 보이고 있습니다.</p>
            </div>

            <h3>2.2 파라미터 추정 결과 요약</h3>
            <table>
                <tr><th>파라미터</th><th>필답형 평가 (평균)</th><th>구술형 평가 (평균)</th></tr>
                <tr><td>난이도 (β)</td><td id="writtenDifficultyMean"></td><td id="oralDifficultyMean"></td></tr>
                <tr><td>변별도 (α)</td><td id="writtenDiscriminationMean"></td><td id="oralDiscriminationMean"></td></tr>
            </table>
            
            <div class="note">
                <h4>파라미터 추정 결과 해석:</h4>
                <ul>
                    <li><strong>난이도 (β):</strong> 
                        <ul>
                            <li>일반적으로 -3에서 +3 사이의 값을 가집니다.</li>
                            <li>값이 높을수록 문항이 더 어렵다는 것을 의미합니다.</li>
                            <li>0은 평균적인 난이도를 나타냅니다.</li>
                            <li>필답형 평가의 평균 난이도가 <span id="writtenDifficultyInterpretation"></span>을 나타냅니다.</li>
                            <li>구술형 평가의 평균 난이도가 <span id="oralDifficultyInterpretation"></span>을 나타냅니다.</li>
                        </ul>
                    </li>
                    <li><strong>변별도 (α):</strong>
                        <ul>
                            <li>일반적으로 0에서 2 사이의 값을 가집니다.</li>
                            <li>값이 높을수록 문항이 수험자의 능력을 잘 구분한다는 것을 의미합니다.</li>
                            <li>0.8 이상이면 높은 변별도, 0.2 이하면 낮은 변별도로 간주됩니다.</li>
                            <li>필답형 평가의 평균 변별도는 <span id="writtenDiscriminationInterpretation"></span>입니다.</li>
                            <li>구술형 평가의 평균 변별도는 <span id="oralDiscriminationInterpretation"></span>입니다.</li>
                        </ul>
                    </li>
                </ul>
                <p>이 결과를 통해 전반적인 시험의 난이도와 변별력을 파악할 수 있으며, 필답형 평가와 구술형 평가의 특성 차이를 비교할 수 있습니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>3. 문항 특성 곡선 (ICC) 분석</h2>
            <p>대표적인 문항의 ICC를 통해 각 문항의 특성을 시각화하였습니다.</p>
            <div class="chart-container">
                <canvas id="iccChart"></canvas>
            </div>
        </div>

        <div class="section">
            <h2>4. 문항 정보 함수 (IIF) 분석</h2>
            <h3>4.1 전체 검사 정보 함수</h3>
            <div class="chart-container">
                <canvas id="testInfoChart"></canvas>
            </div>
        
            <div class="note">
                <h4>전체 검사 정보 함수 해석:</h4>
                <p>전체 검사 정보 함수는 시험이 수험자의 능력을 얼마나 정확하게 측정하는지를 보여줍니다. 주요 특징은 다음과 같습니다:</p>
                <ul>
                    <li><strong>정보량의 크기:</strong> 그래프의 y축 값이 클수록 해당 능력 수준에서 시험의 측정 정확도가 높습니다.</li>
                    <li><strong>정보 함수의 피크:</strong> 그래프의 최고점은 시험이 가장 정확하게 측정하는 능력 수준을 나타냅니다. 이 시험의 경우, 능력 수준 <span id="peakTheta"></span>에서 가장 높은 정보량을 보이고 있습니다.</li>
                    <li><strong>정보 함수의 폭:</strong> 그래프가 넓게 퍼져 있을수록 다양한 능력 수준을 잘 측정할 수 있습니다. 이 시험은 능력 수준 <span id="infoRange"></span> 범위에서 비교적 안정적인 측정을 제공합니다.</li>
                    <li><strong>비대칭성:</strong> 그래프가 한쪽으로 치우쳐 있다면, 시험이 특정 능력 수준에 더 적합하다는 것을 의미합니다. 이 시험의 경우, <span id="asymmetry"></span>쪽으로 약간 치우쳐 있어, <span id="asymmetryInterpretation"></span> 수험자의 능력을 더 정확하게 측정할 수 있습니다.</li>
                </ul>
                <p>이 정보를 바탕으로, 시험 개발자는 목표로 하는 능력 수준에 맞게 시험의 난이도를 조정하거나, 특정 능력 범위에서의 측정 정확도를 개선하기 위해 문항을 수정할 수 있습니다.</p>
            </div>

            <h3>4.2 주요 문항의 IIF</h3>
            <div class="chart-container">
                <canvas id="iifChart"></canvas>
            </div>
        </div>

        <div class="section">
            <h2>5. 차별 기능 문항 (DIF) 분석</h2>
            <p>성별과 국적을 기준으로 DIF 분석을 실시하였습니다.</p>
            <table>
                <tr><th>문항 번호</th><th>성별 DIF</th><th>국적 DIF</th></tr>
                <tr><td>1</td><td>0.023</td><td>0.045</td></tr>
                <tr><td>2</td><td>0.031</td><td>0.052</td></tr>
                <tr><td>3</td><td>0.019</td><td>0.038</td></tr>
                <!-- 추가 행 생략 -->
            </table>
        </div>

        <div class="section">
            <h2>6. 결론 및 제언</h2>
            <ul>
                <li>대부분의 문항이 적절한 난이도와 변별도를 보이고 있으나, 일부 문항의 개선이 필요합니다.</li>
                <li>구술형 평가의 경우, 모든 문항이 높은 변별도를 보이고 있어 응시자의 능력을 잘 구분하고 있습니다.</li>
                <li>DIF 분석 결과, 성별이나 국적에 따른 큰 차이는 발견되지 않았습니다.</li>
                <li>향후 연구에서는 더 큰 표본을 대상으로 분석을 실시하여 결과의 안정성을 높일 필요가 있습니다.</li>
            </ul>
        </div>
    </div>

    <footer>
        <p>본 가이드라인은 2024년 9월 기준으로 작성되었습니다. 향후 시험 정책 변경에 따라 내용이 수정될 수 있습니다.</p>
    </footer>
    
    <script type="module">
        import { df_irt, s_irt } from './data.js';

        function calculateMean(data, key) {
            return data.reduce((sum, item) => sum + item[key], 0) / data.length;
        }

        window.onload = function() {
            // 평균 계산 및 표시
            document.getElementById('writtenDifficultyMean').textContent = calculateMean(df_irt, '난이도 (beta)').toFixed(3);
            document.getElementById('writtenDiscriminationMean').textContent = calculateMean(df_irt, '변별도 (alpha)').toFixed(3);
            document.getElementById('oralDifficultyMean').textContent = calculateMean(s_irt, '난이도 (beta)').toFixed(3);
            document.getElementById('oralDiscriminationMean').textContent = calculateMean(s_irt, '변별도 (alpha)').toFixed(3);

            // 능력값(θ) 배열 생성 함수
            function generateThetaValues() {
                return Array.from({length: 21}, (_, i) => Number((-3 + i * 0.3).toFixed(3)));
            }

            // 차트 생성 시 labels 부분을 수정
            const thetaValues = generateThetaValues();

            // ICC 차트
            const iccCtx = document.getElementById('iccChart').getContext('2d');
            new Chart(iccCtx, {
                type: 'line',
                data: {
                    labels: thetaValues,
                    datasets: [
                        {
                            label: '문항 1',
                            data: Array.from({length: 21}, (_, i) => 1 / (1 + Math.exp(-1.7 * 0.8719177719 * (-3 + i * 0.3 - 0.0350061845)))),
                            borderColor: 'rgba(255, 99, 132, 1)',
                            fill: false
                        },
                        {
                            label: '문항 16',
                            data: Array.from({length: 21}, (_, i) => 1 / (1 + Math.exp(-1.7 * 1.2474251747 * (-3 + i * 0.3 - 0.2814261663)))),
                            borderColor: 'rgba(54, 162, 235, 1)',
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: '문항 특성 곡선 (ICC)'
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '능력 (θ)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '정답 확률'
                            }
                        }
                    }
                }
            });

            // 전체 검사 정보 함수 차트
            const testInfoCtx = document.getElementById('testInfoChart').getContext('2d');
            new Chart(testInfoCtx, {
                type: 'line',
                data: {
                    labels: thetaValues,
                    datasets: [{
                        label: '검사 정보',
                        data: Array.from({length: 21}, (_, i) => {
                            return df_irt.reduce((sum, item) => {
                                const p = 1 / (1 + Math.exp(-1.7 * item['변별도 (alpha)'] * (-3 + i * 0.3 - item['난이도 (beta)'])));
                                return sum + (item['변별도 (alpha)'] ** 2 * p * (1 - p));
                            }, 0);
                        }),
                        borderColor: 'rgba(75, 192, 192, 1)',
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: '전체 검사 정보 함수'
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '능력 (θ)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '정보량'
                            }
                        }
                    }
                }
            });

            // 주요 문항의 IIF 차트
            const iifCtx = document.getElementById('iifChart').getContext('2d');
            new Chart(iifCtx, {
                type: 'line',
                data: {
                    labels: thetaValues,
                    datasets: [1, 16, 24, 43].map(itemNum => {
                        const item = df_irt.find(i => i['문항 번호'] === itemNum);
                        return {
                            label: `문항 ${itemNum}`,
                            data: Array.from({length: 21}, (_, i) => {
                                const p = 1 / (1 + Math.exp(-1.7 * item['변별도 (alpha)'] * (-3 + i * 0.3 - item['난이도 (beta)'])));
                                return item['변별도 (alpha)'] ** 2 * p * (1 - p);
                            }),
                            borderColor: `rgba(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255}, 1)`,
                            fill: false
                        };
                    })
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: '주요 문항의 정보 함수 (IIF)'
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '능력 (θ)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '정보량'
                            }
                        }
                    }
                }
            });

            // 난이도 해석
            function interpretDifficulty(value) {
                if (value < -1) return "매우 쉬운 수준";
                if (value < -0.5) return "쉬운 수준";
                if (value < 0.5) return "중간 수준";
                if (value < 1) return "어려운 수준";
                return "매우 어려운 수준";
            }

            // 변별도 해석
            function interpretDiscrimination(value) {
                if (value < 0.2) return "매우 낮은 변별도";
                if (value < 0.4) return "낮은 변별도";
                if (value < 0.8) return "중간 수준의 변별도";
                if (value < 1.5) return "높은 변별도";
                return "매우 높은 변별도";
            }

            // 난이도 및 변별도 값 설정 및 해석
            const writtenDifficulty = parseFloat(document.getElementById('writtenDifficultyMean').textContent);
            const oralDifficulty = parseFloat(document.getElementById('oralDifficultyMean').textContent);
            const writtenDiscrimination = parseFloat(document.getElementById('writtenDiscriminationMean').textContent);
            const oralDiscrimination = parseFloat(document.getElementById('oralDiscriminationMean').textContent);

            document.getElementById('writtenDifficultyInterpretation').textContent = interpretDifficulty(writtenDifficulty);
            document.getElementById('oralDifficultyInterpretation').textContent = interpretDifficulty(oralDifficulty);
            document.getElementById('writtenDiscriminationInterpretation').textContent = interpretDiscrimination(writtenDiscrimination);
            document.getElementById('oralDiscriminationInterpretation').textContent = interpretDiscrimination(oralDiscrimination);

            // 전체 검사 정보 함수 분석
            const testInfoData = testInfoChart.data.datasets[0].data;
            // const thetaValues = testInfoChart.data.labels;

            // 피크 찾기
            const peakIndex = testInfoData.indexOf(Math.max(...testInfoData));
            const peakTheta = thetaValues[peakIndex];
            document.getElementById('peakTheta').textContent = peakTheta;

            // 정보 범위 찾기 (최대값의 50% 이상인 범위)
            const maxInfo = Math.max(...testInfoData);
            const infoThreshold = maxInfo * 0.5;
            const infoRange = thetaValues.filter((_, i) => testInfoData[i] >= infoThreshold);
            document.getElementById('infoRange').textContent = `${infoRange[0]} 에서 ${infoRange[infoRange.length - 1]}`;

            // 비대칭성 확인
            const leftSum = testInfoData.slice(0, testInfoData.length / 2).reduce((a, b) => a + b, 0);
            const rightSum = testInfoData.slice(testInfoData.length / 2).reduce((a, b) => a + b, 0);
            const asymmetry = leftSum > rightSum ? "왼쪽" : "오른쪽";
            document.getElementById('asymmetry').textContent = asymmetry;
            document.getElementById('asymmetryInterpretation').textContent = asymmetry === "왼쪽" ? "낮은 능력" : "높은 능력";            
        };
    </script>
</body>
</html>