<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>한국어능력시험 정보 함수 분석 및 효율성 평가 보고서</title>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="report-styles.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <style>
            .heatmap-cell { stroke: #fff; }
            .heatmap-legend text { font-size: 10px; }
        </style>
    </head>
<body>
    <div class="container">
        <h1>한국어능력시험 정보 함수 분석 및 효율성 평가 보고서</h1>

        <div class="section">
            <h2>1. 요약</h2>
            <ul>
                <li>시험의 주요 측정 능력 범위: -0.5 ~ 1.0</li>
                <li>정보량 최대 지점: θ = 0.3 (정보량: 15.2)</li>
                <li>정보량 최소 지점: θ = -3.0 (정보량: 2.1)</li>
            </ul>

            <h3>주요 발견사항</h3>
            <ul>
                <li>시험은 중상위 수준의 능력을 가장 정확하게 측정하고 있습니다.</li>
                <li>극단적인 능력 수준(-3 이하, 3 이상)에서는 측정의 정확도가 낮습니다.</li>
                <li>응시자의 능력 분포와 시험 정보 함수 간에 약간의 불일치가 있습니다.</li>
                <li>읽기와 쓰기 영역이 다른 영역에 비해 더 많은 정보를 제공하고 있습니다.</li>
            </ul>
        </div>

        <div class="section">
            <h2>2. 시험 정보 함수 분석</h2>
            <div class="chart-container">
                <canvas id="tifChart"></canvas>
            </div>
            <p>시험 정보 함수는 능력 수준 θ = 0.3에서 최대값을 가지며, 이는 이 시험이 중상위 수준의 능력을 가장 정확하게 측정함을 의미합니다.</p>

            <h3>능력 수준별 정보량 히트맵</h3>
            <div id="heatmapChart"></div>
            <p>히트맵에서 볼 수 있듯이, 읽기와 쓰기 영역이 전반적으로 높은 정보량을 제공하고 있습니다. 반면, 말하기 영역은 상대적으로 낮은 정보량을 보이고 있습니다.</p>
        </div>

        <div class="section">
            <h2>3. 응시자 분포와의 일치도 분석</h2>
            <div class="chart-container">
                <canvas id="distributionChart"></canvas>
            </div>
            <p>응시자의 능력 분포와 시험 정보 함수 사이에 약간의 불일치가 관찰됩니다. 시험은 θ = 0.3 근처에서 가장 많은 정보를 제공하지만, 응시자의 능력 분포는 이보다 약간 낮은 구간에 집중되어 있습니다.</p>
        </div>

        <div class="section">
            <h2>4. 평가영역별 정보 제공 분석</h2>
            <div class="chart-container">
                <canvas id="domainInfoChart"></canvas>
            </div>
            <p>읽기와 쓰기 영역이 가장 많은 정보를 제공하고 있으며, 말하기 영역의 정보 제공량이 가장 적습니다. 이는 말하기 영역의 문항 개선이 필요함을 시사합니다.</p>
        </div>

        <div class="section">
            <h2>5. 개선 권고사항</h2>
            <h3>5.1 정보량 부족 구간 개선</h3>
            <ul>
                <li>극단적인 능력 수준(-3 이하, 3 이상)을 측정하는 문항 추가</li>
                <li>특히 고난도 문항(θ > 2)의 비중을 늘려 상위 능력 측정 정확도 향상</li>
            </ul>

            <h3>5.2 응시자 분포 일치도 향상</h3>
            <ul>
                <li>시험의 전반적인 난이도를 약간 낮추어 응시자 분포의 중심과 일치시킴</li>
                <li>θ = -0.5 ~ 0.5 구간의 문항 비중 증가</li>
            </ul>

            <h3>5.3 평가영역 간 균형 개선</h3>
            <ul>
                <li>말하기 영역의 문항 수 증가 또는 문항 품질 개선</li>
                <li>듣기 영역의 변별도 높은 문항 추가</li>
            </ul>
        </div>
    </div>

    <script>
        // 차트 데이터 및 옵션 (실제 데이터로 대체 필요)
        const tifChart = new Chart(
            document.getElementById('tifChart'),
            {
                type: 'line',
                data: {
                    labels: [-3, -2, -1, 0, 1, 2, 3],
                    datasets: [{
                        label: '시험 정보량',
                        data: [2.1, 5, 10, 14, 15.2, 12, 6],
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '시험 정보 함수'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '능력 수준 (θ)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '정보량'
                            }
                        }
                    }
                }
            }
        );

        // D3.js를 사용한 히트맵 구현
        const heatmapData = [
            {ability: -3, domain: '말하기', value: 1},
            {ability: -2, domain: '말하기', value: 2},
            {ability: -1, domain: '말하기', value: 3},
            {ability: 0, domain: '말하기', value: 4},
            {ability: 1, domain: '말하기', value: 3},
            {ability: 2, domain: '말하기', value: 2},
            {ability: 3, domain: '말하기', value: 1},
            {ability: -3, domain: '듣기', value: 2},
            {ability: -2, domain: '듣기', value: 3},
            {ability: -1, domain: '듣기', value: 4},
            {ability: 0, domain: '듣기', value: 5},
            {ability: 1, domain: '듣기', value: 4},
            {ability: 2, domain: '듣기', value: 3},
            {ability: 3, domain: '듣기', value: 2},
            {ability: -3, domain: '읽기', value: 3},
            {ability: -2, domain: '읽기', value: 4},
            {ability: -1, domain: '읽기', value: 5},
            {ability: 0, domain: '읽기', value: 6},
            {ability: 1, domain: '읽기', value: 5},
            {ability: 2, domain: '읽기', value: 4},
            {ability: 3, domain: '읽기', value: 3},
            {ability: -3, domain: '쓰기', value: 3},
            {ability: -2, domain: '쓰기', value: 4},
            {ability: -1, domain: '쓰기', value: 5},
            {ability: 0, domain: '쓰기', value: 6},
            {ability: 1, domain: '쓰기', value: 5},
            {ability: 2, domain: '쓰기', value: 4},
            {ability: 3, domain: '쓰기', value: 3},
        ];

        const margin = {top: 30, right: 30, bottom: 50, left: 70},
              width = 600 - margin.left - margin.right,
              height = 300 - margin.top - margin.bottom;

        const svg = d3.select("#heatmapChart")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const abilities = Array.from(new Set(heatmapData.map(d => d.ability)));
        const domains = Array.from(new Set(heatmapData.map(d => d.domain)));

        const x = d3.scaleBand()
            .range([0, width])
            .domain(abilities)
            .padding(0.01);

        const y = d3.scaleBand()
            .range([height, 0])
            .domain(domains)
            .padding(0.01);

        const color = d3.scaleSequential()
            .interpolator(d3.interpolateBlues)
            .domain([1, d3.max(heatmapData, d => d.value)]);

        svg.selectAll()
            .data(heatmapData)
            .enter()
            .append("rect")
            .attr("x", d => x(d.ability))
            .attr("y", d => y(d.domain))
            .attr("width", x.bandwidth())
            .attr("height", y.bandwidth())
            .style("fill", d => color(d.value))
            .attr("class", "heatmap-cell");

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).tickFormat(d => d))
            .append("text")
            .attr("x", width / 2)
            .attr("y", 40)
            .attr("fill", "black")
            .text("능력 수준 (θ)");

        svg.append("g")
            .call(d3.axisLeft(y))
            .append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", -50)
            .attr("x", -height / 2)
            .attr("fill", "black")
            .text("평가영역");

        const legendWidth = 200;
        const legendHeight = 20;

        const legendScale = d3.scaleLinear()
            .domain(color.domain())
            .range([0, legendWidth]);

        const legendAxis = d3.axisBottom(legendScale)
            .ticks(5)
            .tickFormat(d3.format(".1f"));

        const legend = svg.append("g")
            .attr("transform", `translate(${width - legendWidth}, ${height + 50})`);

        legend.append("g")
            .attr("class", "heatmap-legend")
            .call(legendAxis);

        legend.selectAll()
            .data(color.ticks(100))
            .enter().append("rect")
            .attr("x", d => legendScale(d))
            .attr("y", -legendHeight)
            .attr("width", (legendWidth / 100) + 1)
            .attr("height", legendHeight)
            .style("fill", color);

        legend.append("text")
            .attr("x", legendWidth / 2)
            .attr("y", -30)
            .style("text-anchor", "middle")
            .text("정보량");

        const distributionChart = new Chart(
            document.getElementById('distributionChart'),
            {
                type: 'bar',
                data: {
                    labels: [-3, -2, -1, 0, 1, 2, 3],
                    datasets: [{
                        type: 'bar',
                        label: '응시자 분포',
                        data: [1, 3, 7, 10, 6, 2, 1],
                        backgroundColor: 'rgba(255, 99, 132, 0.5)'
                    },
                    {
                        type: 'line',
                        label: '시험 정보량',
                        data: [2.1, 5, 10, 14, 15.2, 12, 6],
                        borderColor: 'rgb(75, 192, 192)',
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '응시자 분포와 시험 정보 함수'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '능력 수준 (θ)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '응시자 수'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: '정보량'
                            }
                        }
                    }
                }
            }
        );

        const domainInfoChart = new Chart(
            document.getElementById('domainInfoChart'),
            {
                type: 'bar',
                data: {
                    labels: ['말하기', '듣기', '읽기', '쓰기'],
                    datasets: [{
                        label: '평균 정보량',
                        data: [2.5, 3.5, 4.5, 4.5],
                        backgroundColor: 'rgba(75, 192, 192, 0.6)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '평가영역별 평균 정보량'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '평균 정보량'
                            }
                        }
                    }
                }
            }
        );
    </script>
</body>
</html>