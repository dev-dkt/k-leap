<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>한국어능력시험 문항 개선 방안 보고서</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="report-styles.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
  </head>
  <body>
    <div class="container">
      <h1>한국어능력시험 문항 개선 방안 보고서</h1>
      <div class="section">
        <table>
          <tr>
            <th>시험일</th>
            <td>2024년 9월 10일</td>
          </tr>
          <tr>
            <th>시험 유형</th>
            <td>사전평가</td>
          </tr>
          <tr>
            <th>시험장</th>
            <td>CBT평가센터</td>
          </tr>
          <tr>
            <th>시행 회차</th>
            <td>100회차</td>
          </tr>
        </table>
      </div>

      <div class="section">
        <h2>1. 현행 문항 분석 결과</h2>
        <p>
          본 분석은 2024년 9월 10일에 시행된 한국어능력시험 사전평가 결과를
          바탕으로 작성되었습니다.
        </p>

        <h3>1.1 문항 난이도 분포</h3>
        <div class="chart-container">
          <canvas id="difficultyChart"></canvas>
        </div>

        <h3>1.2 문항 변별도 분포</h3>
        <div class="chart-container">
          <canvas id="discriminationChart"></canvas>
        </div>

        <h3>1.3 평가영역별 문항 구성</h3>
        <ul>
          <li>어휘: 14문항</li>
          <li>문법: 14문항</li>
          <li>쓰기: 5문항</li>
          <li>읽기: 5문항</li>
          <li>문화: 12문항</li>
        </ul>
      </div>

      <div class="section">
        <h2>2. 개선 필요 문항 목록</h2>
        <h3>2.1 저변별도 문항 (변별도 < 0.3)</h3>
        <ul id="lowDiscriminationItems"></ul>

        <h3>2.2 극단적 난이도 문항 (난이도 < -2 또는 > 2)</h3>
        <ul id="extremeDifficultyItems"></ul>

        <h3>2.3 고변별도 문항 (변별도 > 1.0)</h3>
        <ul id="highDiscriminationItems"></ul>
      </div>

      <div class="section">
        <h2>3. 문항 유형별 개선 전략</h2>
        <h3>3.1 객관식 문항</h3>
        <ul>
          <li>오답지의 매력도를 높여 추측 가능성을 낮춥니다.</li>
          <li>문항 줄기를 명확하게 작성하여 의도를 분명히 전달합니다.</li>
          <li>실생활 맥락을 반영한 문항을 개발하여 실용성을 높입니다.</li>
        </ul>

        <h3>3.2 주관식 문항</h3>
        <ul>
          <li>채점 기준을 명확히 하여 채점의 일관성을 높입니다.</li>
          <li>부분 점수 부여 기준을 세분화하여 변별력을 향상시킵니다.</li>
          <li>
            다양한 답안이 가능한 개방형 문항을 개발하여 창의성을 평가합니다.
          </li>
        </ul>

        <h3>3.3 구술형 문항</h3>
        <ul>
          <li>실제 의사소통 상황을 반영한 과제를 제시합니다.</li>
          <li>문화적 요소를 포함하여 종합적인 언어 능력을 평가합니다.</li>
          <li>
            난이도별로 다양한 문항을 개발하여 수준별 평가가 가능하도록 합니다.
          </li>
        </ul>
      </div>

      <div class="section">
        <h2>4. 새로운 문항 개발 가이드라인</h2>
        <h3>4.1 적정 난이도 및 변별도 범위</h3>
        <ul>
          <li>난이도: -2.0 ~ 2.0 사이</li>
          <li>변별도: 0.3 ~ 1.5 사이</li>
        </ul>

        <h3>4.2 추측도 최소화 전략</h3>
        <ul>
          <li>4지선다형보다 5지선다형을 사용하여 추측 확률을 낮춥니다.</li>
          <li>
            오답지를 실제적이고 매력적으로 만들어 무작위 선택을 방지합니다.
          </li>
          <li>'모두', '항상', '절대' 등의 극단적인 표현을 피합니다.</li>
        </ul>

        <h3>4.3 평가영역별 균형</h3>
        <p>
          각 평가영역(어휘, 문법, 쓰기, 읽기, 문화)의 문항 수를 균형 있게
          배분하되, 시험의 목적에 따라 특정 영역에 가중치를 둘 수 있습니다.
        </p>
      </div>

      <div class="section">
        <h2>5. 문항 프리테스팅 계획</h2>
        <ol>
          <li>새로 개발된 문항을 소규모 표본(30-50명)에게 시범 적용합니다.</li>
          <li>프리테스팅 결과를 바탕으로 문항 특성을 분석합니다.</li>
          <li>분석 결과에 따라 문항을 수정하거나 폐기합니다.</li>
          <li>수정된 문항에 대해 필요시 2차 프리테스팅을 실시합니다.</li>
          <li>최종 확정된 문항을 문항 은행에 등록합니다.</li>
        </ol>
      </div>
    </div>

    <footer>
      <p>
        본 보고서는 2024년 9월 기준으로 작성되었습니다. 향후 시험 정책 변경에
        따라 내용이 수정될 수 있습니다.
      </p>
    </footer>

    <script type="module">
      import {
        df_questions,
        df_responses,
        df_questions_speaking,
        df_responses_speaking,
        speaking_grading_criteria,
      } from "./data2.js";

      function updateReport() {
        // 난이도 분포 차트 데이터 생성
        const difficultyData = [
          df_questions.filter((q) => parseFloat(q.난이도) < -1.5).length,
          df_questions.filter(
            (q) => parseFloat(q.난이도) >= -1.5 && parseFloat(q.난이도) < -0.5
          ).length,
          df_questions.filter(
            (q) => parseFloat(q.난이도) >= -0.5 && parseFloat(q.난이도) < 0.5
          ).length,
          df_questions.filter(
            (q) => parseFloat(q.난이도) >= 0.5 && parseFloat(q.난이도) < 1.5
          ).length,
          df_questions.filter((q) => parseFloat(q.난이도) >= 1.5).length,
        ];

        // 변별도 분포 차트 데이터 생성
        const discriminationData = [
          df_questions.filter((q) => parseFloat(q.변별도) < 0.2).length,
          df_questions.filter(
            (q) => parseFloat(q.변별도) >= 0.2 && parseFloat(q.변별도) < 0.4
          ).length,
          df_questions.filter(
            (q) => parseFloat(q.변별도) >= 0.4 && parseFloat(q.변별도) < 0.8
          ).length,
          df_questions.filter(
            (q) => parseFloat(q.변별도) >= 0.8 && parseFloat(q.변별도) < 1.0
          ).length,
          df_questions.filter((q) => parseFloat(q.변별도) >= 1.0).length,
        ];

        // 차트 업데이트
        updateChart("difficultyChart", difficultyData, "문항 난이도 분포");
        updateChart(
          "discriminationChart",
          discriminationData,
          "문항 변별도 분포"
        );

        // 평가영역별 문항 구성 업데이트
        const areaComposition = df_questions.reduce((acc, q) => {
          acc[q.평가영역] = (acc[q.평가영역] || 0) + 1;
          return acc;
        }, {});

        const areaList = document.querySelector(".section:nth-of-type(1) ul");
        areaList.innerHTML = Object.entries(areaComposition)
          .map(([area, count]) => `<li>${area}: ${count}문항</li>`)
          .join("");

        // 개선 필요 문항 목록 생성
        const lowDiscriminationItems = df_questions.filter(
          (q) => parseFloat(q.변별도) < 0.3
        );
        const extremeDifficultyItems = df_questions.filter(
          (q) => Math.abs(parseFloat(q.난이도)) > 2
        );
        const highDiscriminationItems = df_questions.filter(
          (q) => parseFloat(q.변별도) > 1.0
        );

        updateItemList("lowDiscriminationItems", lowDiscriminationItems);
        updateItemList("extremeDifficultyItems", extremeDifficultyItems);
        updateItemList("highDiscriminationItems", highDiscriminationItems);

        // 문항 유형별 개선 전략에 데이터 기반 인사이트 추가
        addDataInsights();
      }

      function updateChart(chartId, data, title) {
        const ctx = document.getElementById(chartId).getContext("2d");
        new Chart(ctx, {
          type: "bar",
          data: {
            labels: ["매우 낮음", "낮음", "중간", "높음", "매우 높음"],
            datasets: [
              {
                label: "문항 수",
                data: data,
                backgroundColor: "rgba(54, 162, 235, 0.6)",
                borderColor: "rgba(54, 162, 235, 1)",
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: "문항 수",
                },
              },
            },
            plugins: {
              title: {
                display: true,
                text: title,
              },
            },
          },
        });
      }

      function updateItemList(listId, items) {
        const list = document.getElementById(listId);
        list.innerHTML = items
          .map(
            (item) =>
              `<li>문항 ${item.문제번호}: ${
                listId.includes("Difficulty") ? "난이도" : "변별도"
              } ${parseFloat(
                listId.includes("Difficulty") ? item.난이도 : item.변별도
              ).toFixed(3)}</li>`
          )
          .join("");
      }

      function addDataInsights() {
        const insightsSection = document.querySelector(
          ".section:nth-of-type(3)"
        );
        const insightsParagraph = document.createElement("p");
        insightsParagraph.innerHTML = `
          <strong>데이터 기반 인사이트:</strong> 
          평균 난이도는 ${calculateMean(df_questions, "난이도").toFixed(
            2
          )}이며, 
          평균 변별도는 ${calculateMean(df_questions, "변별도").toFixed(
            2
          )}입니다. 
          특히 주의가 필요한 ${
            lowDiscriminationItems.length
          }개의 저변별도 문항과 
          ${
            extremeDifficultyItems.length
          }개의 극단적 난이도 문항이 식별되었습니다.
        `;
        insightsSection.appendChild(insightsParagraph);
      }

      function calculateMean(data, key) {
        return (
          data.reduce((sum, item) => sum + parseFloat(item[key]), 0) /
          data.length
        );
      }

      window.onload = updateReport;
    </script>
  </body>
</html>
